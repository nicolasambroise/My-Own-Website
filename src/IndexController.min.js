function trackInstalling(e){e.addEventListener("statechange",function(){"installed"==e.state&&updateReady(e)})}function updateReady(e){console.log("New version available"),confirm("New version available, press OK to reload the website")?e.postMessage({action:"skipWaiting"}):alert("Why did you press cancel? You should have confirmed")}if("serviceWorker"in navigator){navigator.serviceWorker.register("/sw.min.js",{scope:"/"}).then(function(e){if(navigator.serviceWorker.controller){if(e.installing)return console.log("Service worker installing"),void trackInstalling(e.installing);if(e.waiting)return console.log("Service worker installed"),void updateReady(e.waiting);e.active&&console.log("Service worker active"),e.addEventListener("updatefound",function(){console.log("Update found !"),trackInstalling(e.installing)})}}).catch(function(e){console.log("Registration failed with "+e)});var refreshing;navigator.serviceWorker.addEventListener("controllerchange",function(){refreshing||(console.log("Refreshing !"),window.location.reload(),refreshing=!0)})}